# クリップボードライブラリ詳細比較

## 各言語のpyperclip相当ライブラリ

### 1. Python - pyperclip
```python
import pyperclip

# 使用例
pyperclip.copy('日報内容')
text = pyperclip.paste()
```

**特徴:**
- ✅ クロスプラットフォーム自動検出
- ✅ 依存関係の自動解決
- ✅ フォールバック機構内蔵
- ✅ 純Pythonで軽量

### 2. Go - 複数の選択肢

#### atotto/clipboard（最も人気）
```go
import "github.com/atotto/clipboard"

// 使用例
err := clipboard.WriteAll("日報内容")
text, err := clipboard.ReadAll()
```

**特徴:**
- ✅ 純Goで実装（CGO不要）
- ✅ クロスプラットフォーム対応
- ✅ シンプルなAPI
- ⚠️ Linux環境でxclip/xsel必要

#### golang-design/clipboard
```go
import "golang.design/x/clipboard"

// 初期化が必要
err := clipboard.Init()
clipboard.Write(clipboard.FmtText, []byte("日報内容"))
```

**特徴:**
- ✅ より高機能（画像対応など）
- ❌ CGO必要（静的バイナリ不可）
- ✅ ネイティブAPI使用で高速

### 3. Node.js - clipboardy

```javascript
const clipboardy = require('clipboardy');
// または
import clipboardy from 'clipboardy';

// 使用例
await clipboardy.write('日報内容');
const text = await clipboardy.read();

// 同期版
clipboardy.writeSync('日報内容');
```

**特徴:**
- ✅ pyperclipとほぼ同等の機能
- ✅ クロスプラットフォーム自動検出
- ✅ WSL対応
- ✅ TypeScript対応
- ⚠️ Linux環境でxclip/xsel必要

### 4. Rust - 複数の選択肢

#### cli-clipboard
```rust
use cli_clipboard::{ClipboardContext, ClipboardProvider};

let mut ctx = ClipboardContext::new().unwrap();
ctx.set_contents("日報内容".to_owned()).unwrap();
let contents = ctx.get_contents().unwrap();
```

**特徴:**
- ✅ 純Rustで実装
- ✅ クロスプラットフォーム対応
- ⚠️ Linux環境でxclip/xsel必要

#### arboard（新しく高機能）
```rust
use arboard::Clipboard;

let mut clipboard = Clipboard::new().unwrap();
clipboard.set_text("日報内容").unwrap();
let text = clipboard.get_text().unwrap();
```

**特徴:**
- ✅ 画像対応
- ✅ より活発にメンテナンス
- ✅ Wayland対応
- ❌ より多くの依存関係

#### copypasta
```rust
use copypasta::{ClipboardContext, ClipboardProvider};

let mut ctx = ClipboardContext::new().unwrap();
ctx.set_contents("日報内容".to_owned()).unwrap();
```

**特徴:**
- ✅ シンプルなAPI
- ✅ 良好なエラーハンドリング
- ⚠️ メンテナンスが不活発

## 機能比較表

| ライブラリ | 言語 | CGO/ネイティブ | Linux依存 | WSL対応 | 画像対応 | 活発度 |
|-----------|------|----------------|-----------|---------|----------|--------|
| pyperclip | Python | 不要 | xclip/xsel | ✅ | ❌ | ⭐⭐⭐ |
| atotto/clipboard | Go | 不要 | xclip/xsel | ✅ | ❌ | ⭐⭐⭐ |
| golang-design/clipboard | Go | 必要 | 不要 | ✅ | ✅ | ⭐⭐ |
| clipboardy | Node.js | 不要 | xclip/xsel | ✅ | ❌ | ⭐⭐⭐⭐ |
| cli-clipboard | Rust | 不要 | xclip/xsel | ✅ | ❌ | ⭐⭐ |
| arboard | Rust | 必要 | 不要 | ✅ | ✅ | ⭐⭐⭐⭐ |

## 実装の簡単さ比較

### 最小実装コード

#### Python (pyperclip)
```python
import pyperclip
pyperclip.copy("日報内容")  # これだけ
```

#### Go (atotto/clipboard)
```go
import "github.com/atotto/clipboard"
clipboard.WriteAll("日報内容")  // これだけ
```

#### Node.js (clipboardy)
```javascript
const clipboardy = require('clipboardy');
clipboardy.writeSync('日報内容');  // これだけ
```

#### Rust (cli-clipboard)
```rust
use cli_clipboard::{ClipboardContext, ClipboardProvider};
let mut ctx = ClipboardContext::new()?;
ctx.set_contents("日報内容".to_owned())?;  // エラーハンドリング必須
```

## 各ライブラリの内部実装

### 共通の実装パターン
```
1. OS検出
2. 適切なバックエンド選択:
   - Windows: WinAPI または clip.exe
   - macOS: pbcopy/pbpaste または NSPasteboard
   - Linux: xclip/xsel または X11 API
   - WSL: clip.exe
3. フォールバック処理
```

### pyperclipの賢い点
```python
# 自動的に利用可能な方法を検索
1. Tkinter（Python標準）
2. pyQt/pyGTK（インストール済みなら）
3. システムコマンド（pbcopy/xclip/clip）
4. WSL検出と対応
```

## 推奨ライブラリ

### 各言語での推奨

1. **Python**: **pyperclip**
   - 最も成熟していて信頼性が高い
   - 豊富なフォールバック

2. **Go**: **atotto/clipboard**
   - CGO不要で配布が簡単
   - シンプルで十分な機能

3. **Node.js**: **clipboardy**
   - pyperclipに最も近い実装
   - 活発にメンテナンスされている

4. **Rust**: **cli-clipboard** または **arboard**
   - テキストのみ: cli-clipboard
   - 高機能が必要: arboard

## エラーハンドリングのベストプラクティス

```go
// Go例
func CopyToClipboard(text string) error {
    err := clipboard.WriteAll(text)
    if err != nil {
        // フォールバック: 手動コピー用に出力
        fmt.Println("クリップボードへのコピーに失敗しました。")
        fmt.Println("以下をコピーしてください:")
        fmt.Println(text)
        return err
    }
    return nil
}
```

## 結論

**pyperclip相当のライブラリは各言語に存在します：**

- **Go**: atotto/clipboard（最も近い）
- **Node.js**: clipboardy（ほぼ同等の機能）
- **Rust**: cli-clipboard（シンプルで実用的）

これらはすべて：
1. クロスプラットフォーム対応
2. シンプルなAPI
3. 自動的なOS検出
4. Linux環境でのxclip/xsel要件は共通

**配布を考慮した選択：**
- CGO不要なライブラリを選ぶ（静的バイナリ可能）
- Linux環境での追加要件は避けられない
- エラー時のフォールバック実装が重要